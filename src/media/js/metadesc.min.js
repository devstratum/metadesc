/** * @package Metadesc * @version 1.12 * @author Sergey Osipov <info@devstratum.ru> * @website https://devstratum.ru * @copyright (c) 2022 Sergey Osipov. All Rights Reserved * @license GNU GPL v2.0 * @report https://github.com/devstratum/metadesc/issues */
document.addEventListener("DOMContentLoaded",function(){let e=document.getElementById("modal-metadesc"),t=new bootstrap.Modal(e,{}),n=e.querySelector(".modal-dialog"),c=e.querySelector(".metadesc-form__title"),r=e.querySelector(".metadesc-form__group"),s=e.querySelector(".metadesc-form__alert"),o=e.querySelector(".metadesc-form__progress"),a=e.querySelector(".button-apply"),d=e.querySelector(".button-cancel"),l,i;var u='<label for="form_description">'+Joomla.JText._("COM_METADESC_FIELD_DESCRIPTION")+'</label><textarea name="description" id="form_description" class="form-control" cols="30" rows="4" maxlength="160"></textarea>';n.classList.add("modal-dialog-centered"),e.addEventListener("show.bs.modal",function(e){s.innerHTML="";let t=e.relatedTarget;i=t.getAttribute("data-bs-id"),l=t.getAttribute("data-bs-type");let n=document.getElementById("metadesc_"+i);e=n.querySelector(".metadesc-title");let o=n.querySelector(".metadesc-description");c.textContent=e.textContent,r.innerHTML=u;let a=r.querySelector("textarea");"object"==typeof o&&null!==o&&(o.classList.remove("update"),a.value=o.querySelector(".text").textContent),shortAndSweet(a,{counterLabel:Joomla.JText._("COM_METADESC_FIELD_DESCRIPTION_COUNT")})}),d.addEventListener("click",function(){t.hide()}),a.addEventListener("click",function(){var e,t,n=r.querySelector("textarea").value;e=i,t=l,n=n,Joomla.request({url:"index.php?option=com_metadesc&task=metadesc."+t+"&id="+e,method:"POST",headers:{"Cache-Control":"no-cache","Content-Type":"application/json"},data:JSON.stringify({id:e,description:n}),onBefore:function(){s.innerHTML="",a.disabled=!0,o.classList.add("active")},onSuccess:function(e){e=JSON.parse(e);!function(e){let t="";switch(e.type){case"success":t='<span class="icon icon-check-circle"></span>';break;case"warning":t='<span class="icon icon-warning"></span>';break;case"danger":t='<span class="icon icon-warning-circle"></span>'}s.innerHTML='<div class="alert alert-'+e.type+'">'+t+"&nbsp;"+e.text+"</div>"}(e.message),function(a){if(0!==a.length&&a.description){var c=String(a.description);let e=document.getElementById("metadesc_"+i),t=e.querySelector(".metadesc-badge"),n=e.querySelector(".metadesc-count"),o=e.querySelector(".metadesc-description");n.textContent=String(c.length),t.classList.remove("bg-danger"),t.classList.add("bg-success"),o.classList.remove("hidden"),o.classList.add("update"),o.querySelector(".text").textContent=c}if(0!==a.length&&a.checkout){let e=document.getElementById("metadesc_"+i),t=e.querySelector(".metadesc-button"),n=e.querySelector(".metadesc-cheockout");t.classList.add("hidden"),n.classList.remove("hidden")}}(e.data)},onError:function(){console.log("ajax error")},onComplete:function(){a.disabled=!1,o.classList.remove("active")}})})});